python .\main.py
- label value counts:
0    1356
3     998
1     494
2     213
Name: label, dtype: int64
ALL: 3061   TRAIN: 2448   TEST: 613
- auto-computed class weight: [0.5643436578171092, 1.549089068825911, 3.5927230046948355, 0.7667835671342685]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[0.5643436578171092, 1.549089068825911,
                             3.5927230046948355, 0.7667835671342685],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 2326, validation data size: 122
Training  :   0%|                                                                                                                                                                          | 0/73 [00:00<?, ?it/s]C:\Users\oicaa4986\AppData\Local\Programs\Python\Python310\lib\site-packages\bert_sklearn\model\pytorch_pretrained\optimization.py:275: UserWarning: This overload of add_ is deprecated:
        add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
        add_(Tensor other, *, Number alpha) (Triggered internally at  ..\torch\csrc\utils\python_arg_parser.cpp:1055.)
  next_m.mul_(beta1).add_(1 - beta1, grad)
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:37<00:00,  1.95it/s, loss=0.88]
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.69it/s] 
Epoch 1, Train loss: 0.8798, Val loss: 0.4967, Val accy: 81.15%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.07it/s, loss=0.287] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.69it/s] 
Epoch 2, Train loss: 0.2865, Val loss: 0.2567, Val accy: 89.34%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.0861] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.67it/s] 
Epoch 3, Train loss: 0.0861, Val loss: 0.2394, Val accy: 88.52%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.0409] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.64it/s] 
Epoch 4, Train loss: 0.0409, Val loss: 0.2796, Val accy: 88.52%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.06it/s, loss=0.0232] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.67it/s] 
Epoch 5, Train loss: 0.0232, Val loss: 0.2842, Val accy: 89.34%

- model saved to: model/EMNLP_biobert/K5_epochs5_0.bin

Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.83it/s] 
Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.89it/s] 

Acc: 0.897      F1:0.881       P: 0.865   R: 0.901


AVG of 1 folds  |  Acc: 0.897    F1:0.881       P: 0.865   R: 0.901

ALL: 3061   TRAIN: 2449   TEST: 612
- auto-computed class weight: [0.5643436578171092, 1.549089068825911, 3.5927230046948355, 0.7667835671342685]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[0.5643436578171092, 1.549089068825911,
                             3.5927230046948355, 0.7667835671342685],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 2327, validation data size: 122
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.07it/s, loss=0.89]
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.67it/s] 
Epoch 1, Train loss: 0.8897, Val loss: 0.3859, Val accy: 85.25%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.268] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.67it/s] 
Epoch 2, Train loss: 0.2682, Val loss: 0.2833, Val accy: 87.70%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.06it/s, loss=0.102] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.64it/s] 
Epoch 3, Train loss: 0.1023, Val loss: 0.2997, Val accy: 93.44%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.0406] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.64it/s] 
Epoch 4, Train loss: 0.0406, Val loss: 0.3108, Val accy: 90.98%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.06it/s, loss=0.0232] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.67it/s] 
Epoch 5, Train loss: 0.0232, Val loss: 0.3093, Val accy: 92.62%

- model saved to: model/EMNLP_biobert/K5_epochs5_1.bin

Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.95it/s] 
Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.86it/s] 

Acc: 0.910      F1:0.891       P: 0.902   R: 0.882


AVG of 2 folds  |  Acc: 0.904    F1:0.886       P: 0.881   R: 0.892

ALL: 3061   TRAIN: 2449   TEST: 612
- auto-computed class weight: [0.5643436578171092, 1.549089068825911, 3.5927230046948355, 0.7667835671342685]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[0.5643436578171092, 1.549089068825911,
                             3.5927230046948355, 0.7667835671342685],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 2327, validation data size: 122
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.06it/s, loss=0.844]
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.70it/s] 
Epoch 1, Train loss: 0.8441, Val loss: 0.4252, Val accy: 86.89%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.266] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.64it/s] 
Epoch 2, Train loss: 0.2664, Val loss: 0.4206, Val accy: 84.43%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.04it/s, loss=0.108] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.68it/s] 
Epoch 3, Train loss: 0.1077, Val loss: 0.4087, Val accy: 90.98%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.0507] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.67it/s] 
Epoch 4, Train loss: 0.0507, Val loss: 0.4034, Val accy: 90.98%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.0357] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.67it/s] 
Epoch 5, Train loss: 0.0357, Val loss: 0.4124, Val accy: 91.80%

- model saved to: model/EMNLP_biobert/K5_epochs5_2.bin

Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.86it/s] 
Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.87it/s] 

Acc: 0.904      F1:0.890       P: 0.892   R: 0.891


AVG of 3 folds  |  Acc: 0.904    F1:0.887       P: 0.883   R: 0.891

ALL: 3061   TRAIN: 2449   TEST: 612
- auto-computed class weight: [0.5643436578171092, 1.549089068825911, 3.5927230046948355, 0.7667835671342685]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[0.5643436578171092, 1.549089068825911,
                             3.5927230046948355, 0.7667835671342685],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 2327, validation data size: 122
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.873]
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.66it/s] 
Epoch 1, Train loss: 0.8726, Val loss: 0.3631, Val accy: 81.97%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.04it/s, loss=0.261] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.67it/s] 
Epoch 2, Train loss: 0.2614, Val loss: 0.3245, Val accy: 86.07%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.04it/s, loss=0.101] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.66it/s] 
Epoch 3, Train loss: 0.1007, Val loss: 0.2386, Val accy: 88.52%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.043] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.65it/s] 
Epoch 4, Train loss: 0.0430, Val loss: 0.1988, Val accy: 90.16%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.06it/s, loss=0.0259] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.64it/s] 
Epoch 5, Train loss: 0.0259, Val loss: 0.1960, Val accy: 90.98%

- model saved to: model/EMNLP_biobert/K5_epochs5_3.bin

Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.85it/s] 
Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.88it/s]

Acc: 0.884      F1:0.856       P: 0.841   R: 0.877


AVG of 4 folds  |  Acc: 0.899    F1:0.879       P: 0.871   R: 0.888

ALL: 3061   TRAIN: 2449   TEST: 612
- auto-computed class weight: [0.5643436578171092, 1.549089068825911, 3.5927230046948355, 0.7667835671342685]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[0.5643436578171092, 1.549089068825911,
                             3.5927230046948355, 0.7667835671342685],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 2327, validation data size: 122
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.853]
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.64it/s] 
Epoch 1, Train loss: 0.8526, Val loss: 0.4259, Val accy: 81.97%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.06it/s, loss=0.284] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.65it/s] 
Epoch 2, Train loss: 0.2839, Val loss: 0.3437, Val accy: 86.89%
Training  : 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.06it/s, loss=0.105] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.68it/s] 
Epoch 3, Train loss: 0.1046, Val loss: 0.3214, Val accy: 88.52%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.05it/s, loss=0.0456] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.65it/s] 
Epoch 4, Train loss: 0.0456, Val loss: 0.3453, Val accy: 87.70%
Training  : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 73/73 [00:35<00:00,  2.06it/s, loss=0.0258] 
Validating: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:09<00:00,  1.65it/s]
Epoch 5, Train loss: 0.0258, Val loss: 0.3369, Val accy: 87.70%

- model saved to: model/EMNLP_biobert/K5_epochs5_4.bin

Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.83it/s] 
Predicting: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.91it/s] 

Acc: 0.904      F1:0.892       P: 0.885   R: 0.901


AVG of 5 folds  |  Acc: 0.900    F1:0.882       P: 0.874   R: 0.890

       Acc  weight  size      P      R     F1    P_0    R_0   F1_0    P_1    R_1   F1_1    P_2    R_2   F1_2    P_3    R_3   F1_3
0    0.897     0.2   613  0.865  0.901  0.881  0.927  0.882  0.904  0.867  0.867  0.867  0.755  0.930  0.833  0.911  0.925  0.918
1    0.910     0.2   612  0.902  0.882  0.891  0.887  0.923  0.904  0.883  0.919  0.901  0.868  0.767  0.815  0.968  0.920  0.943
2    0.904     0.2   612  0.892  0.891  0.890  0.941  0.882  0.910  0.830  0.889  0.859  0.900  0.837  0.867  0.896  0.955  0.925
3    0.884     0.2   612  0.841  0.877  0.856  0.926  0.878  0.902  0.843  0.869  0.856  0.692  0.857  0.766  0.900  0.905  0.903
4    0.904     0.2   612  0.885  0.901  0.892  0.935  0.900  0.917  0.861  0.879  0.870  0.844  0.905  0.874  0.898  0.920  0.909
avg  0.900     0.2   612  0.877  0.890  0.882  0.923  0.893  0.907  0.857  0.885  0.871  0.812  0.859  0.831  0.915  0.925  0.919

create new folder for prediction results: ./pred/EMNLP_biobert_train


output all 5-fold test results to: "./pred/EMNLP_biobert_train/K5_epochs5.csv"

time used: 1285 seconds
<causal-language-use-in-science> 