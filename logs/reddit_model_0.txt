causal-language-use-in-science\main.py
- label value counts:
1    13202
2     4678
3     3121
0      650
Name: label, dtype: int64
ALL: 21651   TRAIN: 17320   TEST: 4331
- auto-computed class weight: [8.327307692307693, 0.4099946977730647, 1.1570649850363404, 1.7342999038769624]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[8.327307692307693, 0.4099946977730647,
                             1.1570649850363404, 1.7342999038769624],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 16454, validation data size: 866
Training  :   0%|                                                                                                                                                                | 0/515 [00:00<?, ?it/s]C:\Users\oicaa4986\AppData\Local\Programs\Python\Python310\lib\site-packages\bert_sklearn\model\pytorch_pretrained\optimization.py:275: UserWarning: This overload of add_ is deprecated:
        add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
        add_(Tensor other, *, Number alpha) (Triggered internally at  ..\torch\csrc\utils\python_arg_parser.cpp:1055.)
  next_m.mul_(beta1).add_(1 - beta1, grad)
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:17<00:00,  2.61it/s, loss=0.956]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  9.05it/s] 
Epoch 1, Train loss: 0.9558, Val loss: 0.7927, Val accy: 62.70%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:14<00:00,  2.65it/s, loss=0.691] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.94it/s] 
Epoch 2, Train loss: 0.6910, Val loss: 0.9017, Val accy: 73.79%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.519] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.73it/s] 
Epoch 3, Train loss: 0.5185, Val loss: 1.1282, Val accy: 72.29%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:18<00:00,  2.60it/s, loss=0.403] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:25<00:00,  4.35it/s] 
Epoch 4, Train loss: 0.4031, Val loss: 1.3053, Val accy: 65.94%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.319] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.76it/s] 
Epoch 5, Train loss: 0.3192, Val loss: 1.4386, Val accy: 72.29%

- model saved to: model/EMNLP_biobert/K5_epochs5_0.bin

Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 22.47it/s] 
Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 22.41it/s] 

Acc: 0.725      F1:0.624       P: 0.626   R: 0.640


AVG of 1 folds  |  Acc: 0.725    F1:0.624       P: 0.626   R: 0.640

ALL: 21651   TRAIN: 17321   TEST: 4330
- auto-computed class weight: [8.327307692307693, 0.4099946977730647, 1.1570649850363404, 1.7342999038769624]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[8.327307692307693, 0.4099946977730647,
                             1.1570649850363404, 1.7342999038769624],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 16455, validation data size: 866
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.968]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.61it/s] 
Epoch 1, Train loss: 0.9681, Val loss: 0.7229, Val accy: 69.63%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.63it/s, loss=0.718] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.65it/s] 
Epoch 2, Train loss: 0.7183, Val loss: 0.7246, Val accy: 68.71%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.63it/s, loss=0.551] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.59it/s] 
Epoch 3, Train loss: 0.5509, Val loss: 0.8313, Val accy: 77.02%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.63it/s, loss=0.423] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.68it/s] 
Epoch 4, Train loss: 0.4233, Val loss: 0.8979, Val accy: 75.52%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.63it/s, loss=0.359] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:13<00:00,  8.00it/s] 
Epoch 5, Train loss: 0.3585, Val loss: 0.9759, Val accy: 75.17%

- model saved to: model/EMNLP_biobert/K5_epochs5_1.bin

Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 21.86it/s] 
Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 22.40it/s] 

Acc: 0.740      F1:0.629       P: 0.650   R: 0.627


AVG of 2 folds  |  Acc: 0.733    F1:0.627       P: 0.637   R: 0.633

ALL: 21651   TRAIN: 17321   TEST: 4330
- auto-computed class weight: [8.327307692307693, 0.4099946977730647, 1.1570649850363404, 1.7342999038769624]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[8.327307692307693, 0.4099946977730647,
                             1.1570649850363404, 1.7342999038769624],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 16455, validation data size: 866
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:14<00:00,  2.64it/s, loss=0.967]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.85it/s] 
Epoch 1, Train loss: 0.9668, Val loss: 0.9189, Val accy: 59.35%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.703] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.69it/s] 
Epoch 2, Train loss: 0.7029, Val loss: 0.9938, Val accy: 73.09%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.63it/s, loss=0.536] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.49it/s] 
Epoch 3, Train loss: 0.5359, Val loss: 1.1327, Val accy: 64.78%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.397] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.72it/s] 
Epoch 4, Train loss: 0.3966, Val loss: 1.4741, Val accy: 68.82%
Training  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:16<00:00,  2.62it/s, loss=0.33] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.61it/s] 
Epoch 5, Train loss: 0.3297, Val loss: 1.5249, Val accy: 69.98%

- model saved to: model/EMNLP_biobert/K5_epochs5_2.bin

Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 22.31it/s] 
Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 22.41it/s]

Acc: 0.741      F1:0.654       P: 0.663   R: 0.658


AVG of 3 folds  |  Acc: 0.735    F1:0.636       P: 0.646   R: 0.642

ALL: 21651   TRAIN: 17321   TEST: 4330
- auto-computed class weight: [8.327307692307693, 0.4099946977730647, 1.1570649850363404, 1.7342999038769624]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[8.327307692307693, 0.4099946977730647,
                             1.1570649850363404, 1.7342999038769624],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 16455, validation data size: 866
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.948]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.57it/s] 
Epoch 1, Train loss: 0.9484, Val loss: 0.7789, Val accy: 66.40%
Training  : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:17<00:00,  2.60it/s, loss=0.66] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.55it/s] 
Epoch 2, Train loss: 0.6601, Val loss: 0.7682, Val accy: 70.09%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:16<00:00,  2.63it/s, loss=0.493] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.72it/s]
Epoch 3, Train loss: 0.4935, Val loss: 1.1113, Val accy: 73.21%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.63it/s, loss=0.376] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.63it/s] 
Epoch 4, Train loss: 0.3762, Val loss: 1.1657, Val accy: 71.25%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.304] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.62it/s] 
Epoch 5, Train loss: 0.3041, Val loss: 1.3160, Val accy: 71.71%

- model saved to: model/EMNLP_biobert/K5_epochs5_3.bin

Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 22.41it/s] 
Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 22.45it/s] 

Acc: 0.714      F1:0.598       P: 0.604   R: 0.605


AVG of 4 folds  |  Acc: 0.730    F1:0.626       P: 0.635   R: 0.633

ALL: 21651   TRAIN: 17321   TEST: 4330
- auto-computed class weight: [8.327307692307693, 0.4099946977730647, 1.1570649850363404, 1.7342999038769624]
Building sklearn text classifier...
BertClassifier(bert_model='biobert-base-cased',
               class_weight=[8.327307692307693, 0.4099946977730647,
                             1.1570649850363404, 1.7342999038769624],
               epochs=5, random_state=0, validation_fraction=0.05)
Loading biobert-base-cased model...
Defaulting to linear classifier/regressor
Loading Tensorflow checkpoint from  model.ckpt-1000000
train data size: 16455, validation data size: 866
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.959]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.79it/s] 
Epoch 1, Train loss: 0.9595, Val loss: 0.9435, Val accy: 60.74%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.695] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.51it/s] 
Epoch 2, Train loss: 0.6949, Val loss: 0.9603, Val accy: 67.55%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.523] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.70it/s] 
Epoch 3, Train loss: 0.5230, Val loss: 1.1682, Val accy: 67.44%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.64it/s, loss=0.405] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.71it/s] 
Epoch 4, Train loss: 0.4050, Val loss: 1.4870, Val accy: 69.98%
Training  : 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 515/515 [03:15<00:00,  2.63it/s, loss=0.323] 
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 109/109 [00:12<00:00,  8.65it/s] 
Epoch 5, Train loss: 0.3227, Val loss: 1.6279, Val accy: 69.98%

- model saved to: model/EMNLP_biobert/K5_epochs5_4.bin

Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 22.44it/s] 
Predicting: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 542/542 [00:24<00:00, 22.40it/s] 

Acc: 0.730      F1:0.615       P: 0.622   R: 0.622


AVG of 5 folds  |  Acc: 0.730    F1:0.624       P: 0.632   R: 0.631

       Acc  weight  size      P      R     F1    P_0    R_0   F1_0    P_1    R_1   F1_1    P_2    R_2   F1_2    P_3    R_3   F1_3
0    0.725     0.2  4331  0.626  0.640  0.624  0.439  0.385  0.410  0.852  0.722  0.782  0.870  0.887  0.878  0.344  0.566  0.428
1    0.740     0.2  4330  0.650  0.627  0.629  0.512  0.338  0.407  0.842  0.761  0.799  0.897  0.881  0.889  0.350  0.527  0.421
2    0.741     0.2  4330  0.663  0.658  0.654  0.566  0.462  0.508  0.846  0.749  0.795  0.893  0.905  0.899  0.345  0.518  0.415
3    0.714     0.2  4330  0.604  0.605  0.598  0.385  0.323  0.351  0.831  0.731  0.778  0.876  0.854  0.865  0.325  0.513  0.398
4    0.730     0.2  4330  0.622  0.622  0.615  0.422  0.331  0.371  0.842  0.740  0.788  0.879  0.889  0.884  0.343  0.529  0.416
avg  0.730     0.2  4330  0.633  0.631  0.624  0.465  0.368  0.410  0.843  0.741  0.788  0.883  0.883  0.883  0.341  0.531  0.415

create new folder for prediction results: ./pred/EMNLP_biobert_train


output all 5-fold test results to: "./pred/EMNLP_biobert_train/K5_epochs5.csv"

time used: 5509 seconds